# ============================================================================
# NIJA PROFIT OPTIMIZATION CONFIGURATION
# ============================================================================
# This configuration enables all profit optimization features for maximum
# performance on Coinbase and Kraken exchanges.
#
# Copy to .env and fill in your API credentials:
#   cp .env.profit_optimized .env
#
# Then edit .env and add your actual API keys.
# ============================================================================

# ============================================================================
# EXCHANGE CREDENTIALS - REQUIRED
# ============================================================================

# Coinbase Advanced Trade API
COINBASE_API_KEY=organizations/{org_id}/apiKeys/{key_id}
COINBASE_API_SECRET="-----BEGIN EC PRIVATE KEY-----
YOUR_PRIVATE_KEY_HERE
-----END EC PRIVATE KEY-----"

# Kraken Pro API (Classic API Key - NOT OAuth)
# Get from: https://www.kraken.com/u/security/api
# Enable permissions: Query Funds, Query Orders, Create Orders, Cancel Orders
KRAKEN_MASTER_API_KEY=your_kraken_api_key_here
KRAKEN_MASTER_API_SECRET=your_kraken_api_secret_here

# ============================================================================
# PROFIT OPTIMIZATION FEATURES - ENABLED BY DEFAULT
# ============================================================================

# Enhanced entry scoring (0-100 weighted system vs basic 1-5)
USE_ENHANCED_SCORING=true

# Market regime detection (adaptive parameters based on market conditions)
USE_REGIME_DETECTION=true

# Stepped profit-taking (partial exits at multiple profit levels)
ENABLE_STEPPED_EXITS=true

# Minimum entry score threshold (out of 100)
# 60 = good setup, 70 = very good, 80+ = excellent
MIN_ENTRY_SCORE_THRESHOLD=60

# ============================================================================
# POSITION SIZING - OPTIMIZED FOR CAPITAL EFFICIENCY
# ============================================================================

# Position sizing (2-10% per position allows more concurrent positions)
MIN_POSITION_PCT=0.02  # 2% minimum
MAX_POSITION_PCT=0.10  # 10% maximum (reduced from 20% for more positions)
MAX_TOTAL_EXPOSURE=0.80  # 80% maximum total exposure

# ============================================================================
# MULTI-EXCHANGE OPTIMIZATION
# ============================================================================

# Enable multi-broker independent trading
MULTI_BROKER_INDEPENDENT=true

# Capital allocation percentages (must sum to 1.0)
COINBASE_CAPITAL_ALLOCATION=0.50  # 50% to Coinbase
KRAKEN_CAPITAL_ALLOCATION=0.50    # 50% to Kraken

# Distribute market scanning across exchanges
DISTRIBUTE_MARKET_SCANNING=true

# ============================================================================
# FEE OPTIMIZATION
# ============================================================================

# Minimum profit targets to beat exchange fees
# Coinbase: 1.4% round-trip fees → target 1.6%+ profit
# Kraken: 0.67% round-trip fees → target 0.8%+ profit

# Coinbase profit targets
COINBASE_MIN_PROFIT_TARGET=0.016   # 1.6% minimum
COINBASE_PREFERRED_PROFIT_TARGET=0.025  # 2.5% preferred

# Kraken profit targets (lower fees = lower targets)
KRAKEN_MIN_PROFIT_TARGET=0.008     # 0.8% minimum
KRAKEN_PREFERRED_PROFIT_TARGET=0.015  # 1.5% preferred

# Broker routing based on position size
PREFER_KRAKEN_FOR_SMALL_POSITIONS=true
SMALL_POSITION_THRESHOLD_USD=100   # Route <$100 positions to Kraken (lower fees)
PREFER_COINBASE_FOR_LIQUIDITY=true
LARGE_POSITION_THRESHOLD_USD=500   # Route >$500 positions to Coinbase (more liquid)

# ============================================================================
# TRADING TIER (AUTO-DETECT OR MANUAL)
# ============================================================================

# Auto-detect tier based on balance, or set manually:
# STARTER ($50-$99), SAVER ($100-$249), INVESTOR ($250-$999),
# INCOME ($1k-$4.9k), LIVABLE ($5k-$24.9k), BALLER ($25k+)
TRADING_TIER=AUTO

# ============================================================================
# ADVANCED FEATURES
# ============================================================================

# Enable pro mode features (advanced position management)
ENABLE_PRO_MODE=true

# Enable aggressive profit-taking mode
AGGRESSIVE_PROFIT_TAKING=true

# Enable emergency liquidation for capital preservation
ENABLE_EMERGENCY_LIQUIDATION=true

# Enable copy trading (for multi-account setups)
ENABLE_COPY_TRADING=true

# ============================================================================
# MINIMUM BALANCE GUARDS
# ============================================================================

# Minimum balance to execute trades (prevents underfunded trading)
MINIMUM_TRADING_BALANCE=25.0  # $25 minimum (per tier requirements)
MIN_CASH_TO_BUY=5.0  # $5 minimum cash needed to place new trades

# ============================================================================
# RATE LIMITING (PROTECT AGAINST API BANS)
# ============================================================================

# Market scanning delays (prevent 429/403 errors)
MARKET_SCAN_DELAY=8.0  # 8 seconds between market scans
MARKET_SCAN_LIMIT=30   # Scan 30 markets per cycle (rotates through all markets)

# Position check delays
POSITION_CHECK_DELAY=0.5  # 500ms between position checks
SELL_ORDER_DELAY=0.7      # 700ms between sell orders

# ============================================================================
# MONITORING & LOGGING
# ============================================================================

# Enable detailed logging for profit optimization
LOG_ENTRY_SCORES=true       # Log entry signal scores
LOG_REGIME_CHANGES=true     # Log market regime changes
LOG_STEPPED_EXITS=true      # Log stepped profit-taking exits
LOG_FEE_OPTIMIZATION=true   # Log fee optimization routing decisions

# ============================================================================
# OPTIONAL: DISABLE SPECIFIC PAIRS
# ============================================================================

# Comma-separated list of pairs to disable (e.g., pairs with poor performance)
# Default: XRP-USD is disabled due to negative profitability
DISABLED_PAIRS=XRP-USD,XRPUSD,XRP-USDT

# ============================================================================
# DEPLOYMENT SETTINGS
# ============================================================================

# Port for health checks (Railway/Render requirement)
PORT=5000

# Web concurrency for gunicorn
WEB_CONCURRENCY=1

# Paper trading mode (set to false for live trading)
PAPER_MODE=false

# Allow consumer USD accounts in balance (Coinbase-specific)
ALLOW_CONSUMER_USD=true

# ============================================================================
# NOTES
# ============================================================================
#
# 1. This configuration is optimized for profitability on both Coinbase and Kraken
# 2. Enhanced scoring and regime detection improve entry quality
# 3. Stepped profit-taking locks in gains at multiple levels
# 4. Fee optimization routes trades to the best exchange
# 5. Multi-exchange allocation reduces risk and finds more opportunities
# 6. Conservative position sizing (2-10%) enables more concurrent positions
#
# For detailed documentation, see:
# - MULTI_EXCHANGE_TRADING_GUIDE.md
# - KRAKEN_TRADING_GUIDE.md
# - RISK_PROFILES_GUIDE.md
#
# ============================================================================
