# .env.example - copy to .env and fill with real values (do NOT commit .env)
#
# ============================================================================
# QUICK START PRESETS
# ============================================================================
# For specific use cases, you can use these preset configuration templates:
#
# 1. PLATFORM_ONLY Mode (A+ setups, BTC/ETH/SOL only, 3-5% risk)
#    Copy: cp .env.master_only .env
#    Guide: See PLATFORM_ONLY_GUIDE.md
#
# 2. Small Account Preset ($50-$250 accounts)
#    Copy: cp .env.small_account_preset .env
#    Guide: See SMALL_ACCOUNT_QUICKSTART.md
#
# Or customize this .env.example file for your specific needs
# ============================================================================

# ============================================================================
# KRAKEN EXCHANGE - PRIMARY BROKER
# ============================================================================
# Get credentials from: https://www.kraken.com/u/security/api
#
# IMPORTANT: Must use "Classic API Key" (NOT OAuth or App keys)
# To create: Settings > API > Generate New Key
#
# Required Permissions (ALL must be enabled):
#   ‚úÖ Query Funds
#   ‚úÖ Query Open Orders & Trades
#   ‚úÖ Query Closed Orders & Trades
#   ‚úÖ Create & Modify Orders
#   ‚úÖ Cancel/Close Orders
#   ‚ùå Do NOT enable "Withdraw Funds"
#
# MASTER ACCOUNT (Nija system trading account):
# üîß FIX #1: Use these exact variable names (not legacy KRAKEN_API_KEY)
KRAKEN_PLATFORM_API_KEY=
KRAKEN_PLATFORM_API_SECRET=
#
# USER ACCOUNTS (Individual user/investor accounts):
# Format: KRAKEN_USER_{FIRSTNAME}_API_KEY
# The {FIRSTNAME} is extracted from the user_id in config/users/kraken_users.json
# Example: user_id "daivon_frazier" ‚Üí KRAKEN_USER_DAIVON_*
#
KRAKEN_USER_DAIVON_API_KEY=
KRAKEN_USER_DAIVON_API_SECRET=
#
KRAKEN_USER_TANIA_API_KEY=
KRAKEN_USER_TANIA_API_SECRET=
#
# Add more users by following the pattern:
# KRAKEN_USER_{FIRSTNAME}_API_KEY=
# KRAKEN_USER_{FIRSTNAME}_API_SECRET=
#
# Legacy credentials (for backward compatibility, optional):
# Only used if KRAKEN_PLATFORM_* not set
KRAKEN_API_KEY=
KRAKEN_API_SECRET=

# ============================================================================
# KRAKEN TRADING CONFIGURATION (Safety Tuning)
# ============================================================================
# Kraken-specific aggressiveness tuning (Jan 30, 2026)
# These parameters provide safer, more conservative thresholds for Kraken trading
# Adjust these values to tune trade quality vs frequency
#
# RSI Range Configuration:
# KRAKEN_MIN_RSI: Lower value = more aggressive (allows lower RSI, wider range on low end)
# KRAKEN_MAX_RSI: Higher value = more aggressive (allows higher RSI, wider range on high end)
# Default: 35-65 (more conservative than general 30-70)
KRAKEN_MIN_RSI=35  # Minimum RSI for trade entry (avoid extreme oversold)
KRAKEN_MAX_RSI=65  # Maximum RSI for trade entry (avoid extreme overbought)
#
# Confidence Threshold (default: 0.65, higher than general 0.60)
# - Lower values = more trades (more aggressive)
# - Higher values = fewer but higher quality trades (more conservative)
KRAKEN_MIN_CONFIDENCE=0.65  # Minimum confidence score (0.0-1.0)
#
# Volatility Threshold (default: 0.6%, higher than general 0.5%)
# - Lower values = more trades in calmer markets
# - Higher values = only trade in volatile markets (better R:R)
KRAKEN_MIN_ATR_PCT=0.6  # Minimum ATR as percentage (e.g., 0.6 = 0.6%)

# ============================================================================
# COINBASE EXCHANGE - DISABLED (Jan 30, 2026)
# ============================================================================
# Coinbase connection has been disabled per user request
# Kraken is now the exclusive primary broker
#
# If you need to re-enable Coinbase in the future, uncomment these lines
# and the connection code in bot/trading_strategy.py
#
# Get credentials from: https://portal.cdp.coinbase.com/
#
# # New API format (Cloud API Key):
# # The API key is in the format: organizations/{org_id}/apiKeys/{key_id}
# # The API secret is the EC private key (PEM format)
# COINBASE_API_KEY=organizations/ce77e4ea-ecca-42ec-912a-b6b4455ab9d0/apiKeys/your-api-key-id
# COINBASE_API_SECRET="-----BEGIN EC PRIVATE KEY-----
# YOUR_PRIVATE_KEY_HERE
# -----END EC PRIVATE KEY-----"
#
# # Legacy JWT format (if using older credentials):
# # COINBASE_ORG_ID=14f3af21-7544-412c-8409-98dc92cd2eec
# # COINBASE_JWT_PEM="-----BEGIN EC PRIVATE KEY-----\nYOUR_KEY_HERE\n-----END EC PRIVATE KEY-----"
# # COINBASE_JWT_KID=d3c4f66b-809e-4ce4-9d6c-1a8d31b777d5
# # COINBASE_JWT_ISSUER=organizations/14f3af21-7544-412c-8409-98dc92cd2eec
#
# # Optional overrides
# COINBASE_API_BASE=  # set if you need a different base than default brokerage path
#
# # Portfolio selection (optional)
# # Set this to the UUID of a specific portfolio to use for trading
# # Use find_usd_portfolio.py to list all portfolios and their UUIDs
# COINBASE_RETAIL_PORTFOLIO_ID=
#
# # Balance detection (optional)
# # By default, consumer/retail USD accounts are excluded from trading balance
# # Set to "true" or "1" to include consumer USD accounts in trading balance
# ALLOW_CONSUMER_USD=False

# ============================================================================
# ALPACA TRADING (Stocks)
# ============================================================================
# Get credentials from: https://alpaca.markets/
# Use paper trading credentials for testing
#
# MASTER ACCOUNT (Nija system trading account):
ALPACA_API_KEY=
ALPACA_API_SECRET=
ALPACA_PAPER=true  # Set to false for live trading
#
# USER ACCOUNTS (Individual user/investor accounts):
# Format: ALPACA_USER_{FIRSTNAME}_API_KEY
# The {FIRSTNAME} is extracted from the user_id in config/users/alpaca_users.json
#
ALPACA_USER_TANIA_API_KEY=
ALPACA_USER_TANIA_API_SECRET=
ALPACA_USER_TANIA_PAPER=true  # Set to false for live trading
#
# Add more users by following the pattern:
# ALPACA_USER_{FIRSTNAME}_API_KEY=
# ALPACA_USER_{FIRSTNAME}_API_SECRET=
# ALPACA_USER_{FIRSTNAME}_PAPER=true
#
# For testing, use these paper trading credentials:
# ALPACA_API_KEY=PKS2NORMEX6BMN6P3T63C7ICZ2
# ALPACA_API_SECRET=GPmZyiXDoP3A8VcsjcdiCcmdBdzFQnBsmyGSTFQpWyPJ
# ALPACA_PAPER=true

# ============================================================================
# OKX EXCHANGE (Optional)
# ============================================================================
# Get credentials from: https://www.okx.com/account/my-api
OKX_API_KEY=
OKX_API_SECRET=
OKX_PASSPHRASE=
OKX_USE_TESTNET=false  # Set to true for demo trading

# ============================================================================
# BINANCE EXCHANGE (Optional)
# ============================================================================
# Get credentials from: https://www.binance.com/en/my/settings/api-management
BINANCE_API_KEY=
BINANCE_API_SECRET=
BINANCE_USE_TESTNET=false  # Set to true for demo trading

# ============================================================================
# SECURITY CONFIGURATION (REQUIRED FOR PRODUCTION)
# ============================================================================
# These environment variables are REQUIRED for secure operation.
# The application will fail to start if they are not set properly.

# TradingView Webhook Secret (REQUIRED)
# Used to authenticate incoming webhook requests from TradingView
# SECURITY: Must be at least 32 characters long
# Generate with: openssl rand -hex 32
# CRITICAL: Never use default values - generates unique secret for each deployment
TRADINGVIEW_WEBHOOK_SECRET=

# JWT Secret Key (REQUIRED)
# Used to sign and verify JSON Web Tokens for API authentication
# SECURITY: Must be at least 32 characters long
# Generate with: openssl rand -hex 32
# IMPORTANT: Keep this secret secure - if compromised, all JWTs are invalid
JWT_SECRET_KEY=

# JWT Token Expiration (Optional)
# How long JWT tokens remain valid (in hours)
# Default: 24 hours
# Shorter values = more secure but users must re-authenticate more frequently
JWT_EXPIRATION_HOURS=24

# CORS Allowed Origins (REQUIRED for web frontend)
# Comma-separated list of allowed origins for CORS
# Example: https://app.yourdomain.com,https://dashboard.yourdomain.com
# SECURITY: Never use '*' in production - only allow specific domains
# For local development: http://localhost:3000,http://localhost:5173
ALLOWED_ORIGINS=

# Trusted Hosts (Optional but recommended)
# Comma-separated list of trusted hostnames
# Example: nija-bot.railway.app,api.yourdomain.com
# SECURITY: Helps prevent host header injection attacks
TRUSTED_HOSTS=

# ============================================================================
# BOT CONFIGURATION
# ============================================================================

# TRADING MODE - Independent Trading Model
# Defines how the bot operates in multi-account scenarios.
# Values:
#   - independent: Each account evaluates markets independently using the same
#                  algorithmic strategy. No trade copying or signal distribution.
# Default: independent (see FEATURE_FLAGS.md for details)
# Security: Ensures no hierarchical trading models that could trigger regulatory concerns
TRADING_MODE=independent


# CRITICAL SAFETY: LIVE CAPITAL VERIFIED Kill-Switch
# This is the MASTER safety control that must be explicitly enabled for live trading.
# Set to 'true' only when you have verified that:
#   1. All API credentials are correct
#   2. You understand the risks of live trading
#   3. You are ready to trade with real capital
# Default: false (trading disabled - safe mode)
LIVE_CAPITAL_VERIFIED=false

# HEARTBEAT TRADE - Verification Mode
# Enable a single tiny test trade to verify bot connectivity and trading functionality
# When enabled, the bot will execute ONE small trade (typically $5-10) and then disable itself
# This is useful for verifying:
#   1. API credentials are working correctly
#   2. Trading logic is functioning
#   3. Orders can be placed and executed
# IMPORTANT: Disable this after the heartbeat trade completes to resume normal trading
# Default: false (disabled)
HEARTBEAT_TRADE=false

# DRY-RUN SIMULATOR MODE - App Store Review Mode
# Enable simulated trading mode for App Store reviewers and testing
# When enabled, the bot:
#   1. Evaluates signals normally using live market data
#   2. Tracks last evaluated trade for UI display
#   3. DOES NOT place real orders - all trades are simulated
#   4. Shows trading logic and decision-making without real money
# This mode is perfect for:
#   - App Store review process
#   - Testing strategy logic
#   - Demonstrating bot functionality safely
# Default: false (disabled - real trading mode)
DRY_RUN_MODE=false
# Heartbeat Trade (Verification & Health Check)
# When enabled, the bot executes a tiny test trade periodically to verify:
#   - Exchange connectivity is working
#   - Order execution is functioning
#   - API credentials are valid
# This is useful for:
#   - Verifying new deployments (enable briefly, confirm 1 trade, then disable)
#   - Monitoring exchange connectivity health
# Default: false (disabled)
# Set to true only for verification, then disable after confirming execution
HEARTBEAT_TRADE=false
# Heartbeat trade size in USD (default: $5.50 - minimum viable trade)
HEARTBEAT_TRADE_SIZE=5.50
# Heartbeat trade interval in seconds (default: 600 = 10 minutes)
HEARTBEAT_TRADE_INTERVAL=600

LIVE_TRADING=1
RETRY_DELAY=5
MAX_RETRIES=5
MIN_TRADE_PERCENT=0.02
MAX_TRADE_PERCENT=0.10
DEFAULT_TRADE_PERCENT=0.02

# Position Management
MAX_CONCURRENT_POSITIONS=7
MIN_CASH_TO_BUY=5.50
MINIMUM_TRADING_BALANCE=25.0
REENTRY_COOLDOWN_MINUTES=120

# Small Account Configuration
# For accounts under $25, you can lower these minimums:
# MINIMUM_TRADING_BALANCE=15.0  # Minimum balance to start trading (default: 25.0)
# MIN_CASH_TO_BUY=5.0           # Minimum cash to place buy order (default: 5.50)

# Multi-Broker Independent Trading
# When enabled, each broker runs in its own isolated thread
# Failures in one broker won't affect trading on other brokers
MULTI_BROKER_INDEPENDENT=true

# Suppress Single Exchange Warning
# Set to "true" or "1" to suppress the warning when only one exchange is connected
# Default: false (show warning to encourage multi-exchange trading)
SUPPRESS_SINGLE_EXCHANGE_WARNING=false

# ============================================================================
# PRO MODE - Position Rotation Trading (ADVANCED)
# ============================================================================
# PRO MODE enables hedge-fund style position rotation:
#   - Open position values count as available capital
#   - Bot can close weak positions to fund better opportunities
#   - Never locks all capital (maintains minimum free reserve)
#   - Uses total capital (free + positions) for position sizing
#
# ‚ö†Ô∏è  RISK WARNING: More aggressive trading, higher complexity
# ‚úÖ  BENEFIT: Never "starves" by having all capital locked in positions
#
# Enable/disable PRO MODE
PRO_MODE=true
#
# Minimum free balance reserve % (default: 15%)
# Bot will maintain at least this % of total capital as free USD
# Example: With $100 total capital and 15% reserve, bot keeps minimum $15 free
PRO_MODE_MIN_RESERVE_PCT=0.15

# Initial Capital Configuration
# INITIAL_CAPITAL determines how the system tracks starting capital.
# Options:
#   - auto: Use live broker balance automatically (RECOMMENDED - most accurate)
#   - LIVE: Same as "auto" - uses live broker balance (alias for compatibility)
#   - <number>: Set explicit starting capital (e.g., 100, 250, 1000)
#
# RECOMMENDATION: Set to "auto" for clean user accounting with real-time balance
# For STARTER tier ($50-$99), this requirement is waived.
#
# RECOMMENDATION: Set to "auto" for clean user accounting with real-time balance
INITIAL_CAPITAL=auto

# Disabled Trading Pairs
# Comma-separated list of pairs to disable globally (e.g., XRP-USD for small accounts)
# XRP is disabled by default on ALL exchanges due to high spreads and low profit potential
# Note: Individual users can also configure disabled_symbols in their user config JSON files
# Global disabled pairs are hardcoded in trading_strategy.py + additional pairs from this env var
DISABLED_PAIRS=XRP-USD

# ============================================================================
# SYMBOL WHITELIST (OPTIONAL - FOR FOCUSED TRADING)
# ============================================================================
# Enable symbol whitelist to only trade specific cryptocurrencies
# When enabled, ONLY the symbols in the whitelist will be traded
# This is useful for focused strategies (e.g., BTC/ETH/SOL only)
#
# Set to "true" to enable whitelist mode (see bot/master_only_config.py)
# Default: false (trade all available symbols except blacklisted)
ENABLE_SYMBOL_WHITELIST=false
#
# The whitelist is defined in bot/master_only_config.py
# Default whitelist: BTC-USD, ETH-USD, SOL-USD
#
# See PLATFORM_ONLY_GUIDE.md for the complete PLATFORM_ONLY mode setup

# ============================================================================
# STABLECOIN TRADING POLICY
# ============================================================================
# Configure how NIJA handles stablecoin trading pairs (USDT, USDC, DAI, BUSD)
#
# Available policies:
#   - route_to_kraken: Route all stablecoin trades to Kraken (lower fees, recommended)
#   - block_all: Block all stablecoin trading pairs
#   - allow_all: Allow stablecoin trades on any configured broker
#
# Default: route_to_kraken
STABLECOIN_POLICY=route_to_kraken

# ============================================================================
# TIER-BASED MINIMUM TRADE SIZES
# ============================================================================
# Minimum visible trade size per tier (trades smaller than this are executed
# but not shown prominently in the activity feed)
#
# Tier structure:
#   STARTER ($50-$99):    Min visible: $10, Max risk: 10-15%
#   SAVER ($100-$249):    Min visible: $15, Max risk: 7-10%
#   INVESTOR ($250-$999): Min visible: $20, Max risk: 5-7%
#   INCOME ($1k-$5k):     Min visible: $30, Max risk: 3-5%
#   LIVABLE ($5k-$25k):   Min visible: $50, Max risk: 2-3%
#   BALLER ($25k+):       Min visible: $100, Max risk: 1-2%
#
# ‚ö†Ô∏è IMPORTANT: Master account is ALWAYS BALLER tier regardless of balance
# This provides the best risk management parameters (1-2% max risk per tier guidelines)
# with the global 15% max trade size cap still enforced
#
# These are automatically applied based on account balance for user accounts
# No manual configuration needed - NIJA detects tier from balance
#
# ADVANCED: Force a specific tier for user accounts (bypasses auto-detection)
# Useful for small user accounts that need better risk management of higher tiers
# Set to: STARTER, SAVER, INVESTOR, INCOME, LIVABLE, BALLER, or MASTER
# Leave empty or commented out for automatic tier detection
# For master account: Set to BALLER or MASTER (both enforce BALLER tier)
# Example: PLATFORM_ACCOUNT_TIER=BALLER
PLATFORM_ACCOUNT_TIER=BALLER

# ============================================================================
# NOTES ON USER CONFIGURATION
# ============================================================================
#
# USER ACCOUNTS are configured in JSON files, not in this .env file:
#   - config/users/retail_kraken.json - Retail users on Kraken
#   - config/users/retail_alpaca.json - Retail users on Alpaca
#   - config/users/retail_coinbase.json - Retail users on Coinbase
#   - config/users/investor_kraken.json - Investor accounts on Kraken
#   - config/users/investor_alpaca.json - Investor accounts on Alpaca
#   - config/users/investor_coinbase.json - Investor accounts on Coinbase
#
# To add a new user:
# 1. Edit the appropriate JSON file in config/users/
# 2. Add the user's credentials to this .env file following the pattern above
# 3. Restart the bot
#
# See USER_SETUP_GUIDE.md for detailed instructions.
#
# Environment variable naming pattern:
#   {BROKER}_USER_{FIRSTNAME}_API_KEY
#   {BROKER}_USER_{FIRSTNAME}_API_SECRET
#
# Example:
#   user_id: "jane_smith" in retail_kraken.json
#   Environment variables:
#     KRAKEN_USER_JANE_API_KEY=...
#     KRAKEN_USER_JANE_API_SECRET=...
#
# The {FIRSTNAME} is extracted from user_id (part before first underscore, uppercase)

# ============================================================================
# FEATURE FLAGS
# ============================================================================
# Control optional features and experimental functionality
# Format: FEATURE_{FLAG_NAME}=true|false
#
# Available Feature Flags:
#
# PROFIT_CONFIRMATION - Profit Confirmation Logging
# Enables detailed tracking and logging of profit confirmations with metrics
# When enabled: Tracks profit confirmations, givebacks, and generates reports
# When disabled: Skips profit confirmation tracking (lightweight mode)
# Default: true (recommended for production trading)
# Can also be imported from config.feature_flags import PROFIT_CONFIRMATION_AVAILABLE
FEATURE_PROFIT_CONFIRMATION=true
#
# ENTRY_QUALITY_AUDIT - Entry Quality Auditing (Experimental)
# Default: false
# FEATURE_ENTRY_QUALITY_AUDIT=false
#
# VOLATILITY_ADAPTIVE_SIZING - Volatility-Based Position Sizing (Experimental)
# Default: false
# FEATURE_VOLATILITY_ADAPTIVE_SIZING=false
#
# DYNAMIC_STOP_EXPANSION - Dynamic Stop Loss Expansion (Experimental)
# Default: false
# FEATURE_DYNAMIC_STOP_EXPANSION=false
#
# LIVE_DASHBOARD - Live Trading Dashboard (Experimental)
# Default: false
# FEATURE_LIVE_DASHBOARD=false
#
# Note: Safety features (PROFITABILITY_ASSERTION, STOP_LOSS_VALIDATION) are
# always enabled and cannot be disabled via feature flags.

# ============================================================================
# POSTGRESQL DATABASE (Optional - for multi-user platform)
# ============================================================================
# PostgreSQL connection settings for user management and platform features
# If not using multi-user features, these can be left unset
#
# Option 1: Use complete DATABASE_URL (recommended for cloud platforms)
# ‚ö†Ô∏è  SECURITY: DATABASE_URL must include valid credentials (username:password)
# DATABASE_URL=postgresql://username:password@hostname:5432/database_name
#
# Option 2: Use individual components (will be combined into DATABASE_URL)
# POSTGRES_HOST=localhost
# POSTGRES_PORT=5432
# POSTGRES_DB=nija
# POSTGRES_USER=nija_user
# POSTGRES_PASSWORD=your_secure_password_here  # REQUIRED if using individual components
#
# ‚ö†Ô∏è  SECURITY REQUIREMENT:
# A password is MANDATORY for database security, whether using:
# - DATABASE_URL (must contain :password@ in the URL)
# - Individual components (POSTGRES_PASSWORD must be set)
# The database will not start without valid credentials to prevent security vulnerabilities
