<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ NIJA Operator Quick Reference Card</title>
    <style>
        :root {
            --emergency-red: #dc2626;
            --warning-orange: #ea580c;
            --success-green: #16a34a;
            --info-blue: #2563eb;
            --neutral-gray: #6b7280;
            --bg-dark: #1f2937;
            --bg-light: #f9fafb;
            --border-color: #e5e7eb;
            --text-dark: #111827;
            --text-light: #6b7280;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
            color: white;
            padding: 30px 40px;
            border-bottom: 4px solid var(--emergency-red);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header .subtitle {
            color: #9ca3af;
            font-size: 1.1em;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            border-left: 4px solid var(--border-color);
            padding-left: 20px;
        }

        .section.emergency {
            border-left-color: var(--emergency-red);
            background: #fef2f2;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .section.status {
            border-left-color: var(--info-blue);
        }

        .section.alerts {
            border-left-color: var(--warning-orange);
        }

        .section.snapshots {
            border-left-color: var(--success-green);
        }

        .section.filters {
            border-left-color: #8b5cf6;
        }

        .section-title {
            font-size: 1.8em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .icon {
            font-size: 1.2em;
        }

        .emergency .section-title {
            color: var(--emergency-red);
        }

        .status .section-title {
            color: var(--info-blue);
        }

        .alerts .section-title {
            color: var(--warning-orange);
        }

        .snapshots .section-title {
            color: var(--success-green);
        }

        .filters .section-title {
            color: #8b5cf6;
        }

        .command-box {
            background: var(--bg-dark);
            color: #10b981;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 10px 0;
            overflow-x: auto;
            border: 1px solid #374151;
        }

        .command-box pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .command-box.inline {
            display: inline-block;
            padding: 5px 10px;
            margin: 2px 5px;
            font-size: 0.85em;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin: 2px;
        }

        .badge.emergency {
            background: var(--emergency-red);
            color: white;
        }

        .badge.warning {
            background: var(--warning-orange);
            color: white;
        }

        .badge.success {
            background: var(--success-green);
            color: white;
        }

        .badge.info {
            background: var(--info-blue);
            color: white;
        }

        .badge.neutral {
            background: var(--neutral-gray);
            color: white;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .card {
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .card-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-dark);
        }

        .card-content {
            color: var(--text-light);
            font-size: 0.9em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        table th {
            background: var(--bg-dark);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        table td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--border-color);
        }

        table tr:hover {
            background: var(--bg-light);
        }

        .alert-box {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid;
        }

        .alert-box.critical {
            background: #fef2f2;
            border-left-color: var(--emergency-red);
            color: #991b1b;
        }

        .alert-box.warning {
            background: #fff7ed;
            border-left-color: var(--warning-orange);
            color: #9a3412;
        }

        .alert-box.info {
            background: #eff6ff;
            border-left-color: var(--info-blue);
            color: #1e40af;
        }

        .alert-box.success {
            background: #f0fdf4;
            border-left-color: var(--success-green);
            color: #166534;
        }

        .checklist {
            list-style: none;
            padding-left: 0;
        }

        .checklist li {
            padding: 8px 0;
            padding-left: 30px;
            position: relative;
        }

        .checklist li:before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: var(--success-green);
            font-weight: bold;
            font-size: 1.2em;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .metric-card {
            background: linear-gradient(135deg, var(--bg-dark) 0%, #374151 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .metric-card .metric-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .metric-card .metric-label {
            font-size: 0.9em;
            color: #9ca3af;
            margin-bottom: 5px;
        }

        .metric-card .metric-value {
            font-size: 1.5em;
            font-weight: 700;
        }

        .footer {
            background: var(--bg-dark);
            color: white;
            padding: 20px 40px;
            text-align: center;
            font-size: 0.9em;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .grid, .two-column, .metric-grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .content {
                padding: 20px;
            }
        }

        .highlight {
            background: #fef3c7;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        .quick-action {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .quick-action:hover {
            transform: scale(1.02);
        }

        .quick-action .icon {
            font-size: 2em;
        }

        .quick-action .text {
            flex: 1;
        }

        .quick-action .title {
            font-weight: 700;
            font-size: 1.1em;
        }

        .quick-action .description {
            font-size: 0.9em;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ NIJA Operator Quick Reference Card</h1>
            <div class="subtitle">
                <span class="badge emergency">Version 7.2.0</span>
                <span class="badge info">Emergency Response & Monitoring Guide</span>
                <span class="badge success">Target Response: &lt;30 seconds</span>
            </div>
        </div>

        <div class="content">
            <!-- EMERGENCY KILL SWITCH -->
            <div class="section emergency">
                <h2 class="section-title">
                    <span class="icon">üö®</span>
                    EMERGENCY KILL SWITCH (Priority #1)
                </h2>
                
                <div class="alert-box critical">
                    <strong>‚ö†Ô∏è When to Use:</strong> Uncontrolled losses, API errors, suspicious activity, system malfunction, security breach
                </div>

                <h3>‚ö° Fastest Activation Methods</h3>
                
                <div class="quick-action" style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);">
                    <span class="icon">üöÄ</span>
                    <div class="text">
                        <div class="title">CLI Activation (&lt; 5 seconds) - FASTEST</div>
                        <div class="command-box">python emergency_kill_switch.py activate emergency</div>
                    </div>
                </div>

                <div class="two-column">
                    <div class="card">
                        <div class="card-title">üìÅ File System (&lt; 10 seconds)</div>
                        <div class="command-box">touch EMERGENCY_STOP</div>
                    </div>
                    <div class="card">
                        <div class="card-title">üåê API (&lt; 10 seconds)</div>
                        <div class="command-box">curl -X POST http://localhost:5000/api/emergency/kill-switch/activate</div>
                    </div>
                </div>

                <h3>üìä Check Status</h3>
                <div class="command-box">python emergency_kill_switch.py status
curl http://localhost:5000/api/emergency/kill-switch/status</div>
            </div>

            <!-- STATUS COMMANDS -->
            <div class="section status">
                <h2 class="section-title">
                    <span class="icon">üìä</span>
                    STATUS COMMANDS
                </h2>

                <h3>üí∞ Account & Balance Status</h3>
                <div class="grid">
                    <div class="card">
                        <div class="card-title">Overall Profit Status</div>
                        <div class="command-box inline">python check_profit_status.py</div>
                        <div class="card-content">Kraken + Coinbase P&L</div>
                    </div>
                    <div class="card">
                        <div class="card-title">Capital Capacity</div>
                        <div class="command-box inline">python calculate_capital_capacity.py</div>
                        <div class="card-content">Calculate available capital</div>
                    </div>
                    <div class="card">
                        <div class="card-title">All Accounts Capital</div>
                        <div class="command-box inline">python calculate_all_accounts_capital.py</div>
                        <div class="card-content">Multi-account overview</div>
                    </div>
                    <div class="card">
                        <div class="card-title">Safe Trade Size</div>
                        <div class="command-box inline">python calculate_safe_trade_size.py</div>
                        <div class="card-content">Position sizing calculator</div>
                    </div>
                </div>

                <h3>üîß Trading System Status</h3>
                <div class="grid">
                    <div class="card">
                        <div class="card-title">Diagnose Kraken Trading</div>
                        <div class="command-box inline">python diagnose_kraken_trading.py</div>
                    </div>
                    <div class="card">
                        <div class="card-title">Diagnose Trading Logic</div>
                        <div class="command-box inline">python diagnose_trading_logic.py</div>
                    </div>
                    <div class="card">
                        <div class="card-title">Profitability Analysis</div>
                        <div class="command-box inline">python analyze_profitability.py</div>
                    </div>
                    <div class="card">
                        <div class="card-title">Heartbeat Verification</div>
                        <div class="card-content">Set <span class="highlight">HEARTBEAT_TRADE=true</span> in environment</div>
                    </div>
                </div>

                <h3>üìà Analytics & Reports</h3>
                <div class="command-box">
# Analytics report
python generate_analytics_report.py --detailed

# Paper trading analytics
python paper_trading_manager.py --report
python paper_trading_manager.py --analyze

# Greenlight report
python generate_greenlight_report.py

# Profitability audit
python profitability_audit_report.py
                </div>
            </div>

            <!-- ALERTS & MONITORING -->
            <div class="section alerts">
                <h2 class="section-title">
                    <span class="icon">üîî</span>
                    ALERTS & MONITORING
                </h2>

                <h3>‚ö†Ô∏è Critical Alert Thresholds</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Alert Type</th>
                            <th>Threshold</th>
                            <th>Auto Kill-Switch</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge warning">Order Stuck</span></td>
                            <td>5 minutes</td>
                            <td><span class="badge neutral">Optional (15 min)</span></td>
                        </tr>
                        <tr>
                            <td><span class="badge warning">Adoption Rate</span></td>
                            <td>80%</td>
                            <td><span class="badge info">Configurable</span></td>
                        </tr>
                        <tr>
                            <td><span class="badge warning">Platform Exposure</span></td>
                            <td>30%</td>
                            <td><span class="badge info">Configurable (45%)</span></td>
                        </tr>
                        <tr>
                            <td><span class="badge emergency">Daily Loss Limit</span></td>
                            <td>Per tier config</td>
                            <td><span class="badge emergency">Yes</span></td>
                        </tr>
                        <tr>
                            <td><span class="badge warning">Position Limit</span></td>
                            <td>7 positions</td>
                            <td><span class="badge warning">Blocked</span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>üß™ Run Safety Tests</h3>
                <div class="grid">
                    <div class="card">
                        <div class="card-title">Operational Safety</div>
                        <div class="command-box inline">python test_operational_safety.py</div>
                        <div class="card-content">Expected: <span class="highlight">7/7 tests pass</span></div>
                    </div>
                    <div class="card">
                        <div class="card-title">Critical Safety</div>
                        <div class="command-box inline">python test_critical_safety.py</div>
                    </div>
                    <div class="card">
                        <div class="card-title">Health Check System</div>
                        <div class="command-box inline">python test_health_check_system.py</div>
                    </div>
                </div>
            </div>

            <!-- SNAPSHOTS & METRICS -->
            <div class="section snapshots">
                <h2 class="section-title">
                    <span class="icon">üì∏</span>
                    SNAPSHOTS & METRICS
                </h2>

                <h3>üéØ Command Center Metrics (8 Key Metrics)</h3>
                <div class="alert-box success">
                    <strong>Start Dashboard:</strong> <code>python bot/dashboard_server.py</code><br>
                    <strong>Access:</strong> <code>http://localhost:5001/command-center</code>
                </div>

                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-icon">üìà</div>
                        <div class="metric-label">Equity Curve</div>
                        <div class="metric-value">Portfolio Value</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">üî•</div>
                        <div class="metric-label">Risk Heat</div>
                        <div class="metric-value">0-100 Score</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">‚≠ê</div>
                        <div class="metric-label">Trade Quality</div>
                        <div class="metric-value">Win Rate</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">üéØ</div>
                        <div class="metric-label">Signal Accuracy</div>
                        <div class="metric-value">Success Rate</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">üìä</div>
                        <div class="metric-label">Slippage</div>
                        <div class="metric-value">bps & USD</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">üí∞</div>
                        <div class="metric-label">Fee Impact</div>
                        <div class="metric-value">% of Profit</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">‚ö°</div>
                        <div class="metric-label">Strategy Efficiency</div>
                        <div class="metric-value">Trades/Day</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">üöÄ</div>
                        <div class="metric-label">Capital Growth</div>
                        <div class="metric-value">Annualized Rate</div>
                    </div>
                </div>

                <h3>üåê API Endpoints for Real-Time Data</h3>
                <div class="grid">
                    <div class="card">
                        <div class="card-title">Last Evaluated Trade</div>
                        <div class="command-box inline">GET /api/last-trade</div>
                    </div>
                    <div class="card">
                        <div class="card-title">Health Check</div>
                        <div class="command-box inline">GET /api/health</div>
                    </div>
                    <div class="card">
                        <div class="card-title">Dry-Run Status</div>
                        <div class="command-box inline">GET /api/dry-run-status</div>
                    </div>
                    <div class="card">
                        <div class="card-title">Kill Switch Status</div>
                        <div class="command-box inline">GET /api/emergency/kill-switch/status</div>
                    </div>
                    <div class="card">
                        <div class="card-title">Performance Status</div>
                        <div class="command-box inline">GET /api/performance/status</div>
                    </div>
                    <div class="card">
                        <div class="card-title">Graduation Status</div>
                        <div class="command-box inline">GET /api/graduation/status</div>
                    </div>
                </div>
            </div>

            <!-- MARKET FILTERS -->
            <div class="section filters">
                <h2 class="section-title">
                    <span class="icon">üîç</span>
                    MARKET FILTERS
                </h2>

                <h3>üéõÔ∏è Filter Thresholds (Default)</h3>
                <div class="grid">
                    <div class="card">
                        <div class="card-title">üåä ADX Threshold</div>
                        <div class="card-content">
                            <span class="badge warning">&lt; 20</span>
                            Weak trend, choppy market
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-title">üìä Min Volume</div>
                        <div class="card-content">
                            <span class="badge info">50%</span>
                            Of 20-period average
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-title">‚è±Ô∏è Avoid First</div>
                        <div class="card-content">
                            <span class="badge neutral">30 seconds</span>
                            Of new candle
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-title">üí∏ Max Spread</div>
                        <div class="card-content">
                            <span class="badge warning">10 bps</span>
                            Basis points
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-title">üìâ Low Volatility</div>
                        <div class="card-content">
                            <span class="badge info">ATR &lt; 0.1%</span>
                            Of price
                        </div>
                    </div>
                </div>

                <h3>üß™ Market Quality Filters (Python)</h3>
                <div class="command-box">
from bot.market_filters import (
    detect_choppy_market,
    check_minimum_volume,
    filter_recent_candle_start,
    check_spread_and_slippage
)

# Detect choppy/ranging markets
chop_result = detect_choppy_market(df, adx_threshold=20)
# Returns: {'is_choppy': bool, 'reason': str, 'adx_value': float}

# Check volume sufficiency
vol_result = check_minimum_volume(df, min_volume_multiplier=0.5)

# Avoid trading first seconds of candle
early_candle = filter_recent_candle_start(df, avoid_seconds=30)

# Check spread/slippage
spread_result = check_spread_and_slippage(df, max_spread_bps=10)
                </div>
            </div>

            <!-- TROUBLESHOOTING -->
            <div class="section">
                <h2 class="section-title">
                    <span class="icon">üêõ</span>
                    TROUBLESHOOTING CHECKLIST
                </h2>

                <div class="two-column">
                    <div>
                        <h3>üö´ Bot Won't Start</h3>
                        <ul class="checklist">
                            <li>Check API keys are set</li>
                            <li>Verify order permissions</li>
                            <li>Check logs for errors</li>
                        </ul>
                    </div>
                    <div>
                        <h3>üö´ No Trades Executing</h3>
                        <ul class="checklist">
                            <li>Look for TRADE VETO messages</li>
                            <li>Check veto reasons</li>
                            <li>Verify LIVE_CAPITAL_VERIFIED=true</li>
                            <li>Ensure minimum balance ($25+)</li>
                        </ul>
                    </div>
                </div>

                <div class="two-column">
                    <div>
                        <h3>üö´ Heartbeat Trade Fails</h3>
                        <ul class="checklist">
                            <li>Account has $25+ balance</li>
                            <li>API key has order permission</li>
                            <li>Check logs for API error</li>
                        </ul>
                    </div>
                    <div>
                        <h3>üö´ API Not Responding</h3>
                        <ul class="checklist">
                            <li>Port 5001 is exposed</li>
                            <li>API server started</li>
                            <li>Firewall allows port 5001</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- RAPID FIRE COMMANDS -->
            <div class="section">
                <h2 class="section-title">
                    <span class="icon">‚ö°</span>
                    RAPID FIRE COMMANDS
                </h2>

                <div class="command-box">
# Quick system health check
curl http://localhost:5001/api/health | jq
curl http://localhost:5000/api/emergency/kill-switch/status | jq

# Monitor last trade in real-time
watch -n 5 'curl -s http://localhost:5001/api/last-trade | jq .data'

# Check git status
git --no-pager status && git --no-pager diff

# View recent logs
tail -f logs/nija.log

# Run all safety tests
python test_operational_safety.py && \
python test_critical_safety.py && \
python test_health_check_system.py
                </div>
            </div>

            <!-- EMERGENCY PROTOCOL -->
            <div class="alert-box critical">
                <h3>üö® REMEMBER: In any emergency, activate kill switch FIRST, investigate SECOND!</h3>
                
                <h4>üìû Emergency Protocol:</h4>
                <ol>
                    <li><strong>Activate kill switch immediately</strong> - <code>python emergency_kill_switch.py activate emergency</code></li>
                    <li><strong>Review logs</strong> - <code>tail -f logs/nija.log</code></li>
                    <li><strong>Check positions</strong> via broker UI</li>
                    <li><strong>Follow procedures</strong> in OPERATIONAL_SAFETY_PROCEDURES.md</li>
                    <li><strong>Only deactivate</strong> after issue is resolved and verified</li>
                </ol>
            </div>
        </div>

        <div class="footer">
            <p><strong>NIJA Trading Platform</strong> | Version 7.2.0 | Last Updated: February 2026</p>
            <p style="margin-top: 10px;">
                üìñ Documentation: README.md | EMERGENCY_KILL_SWITCH_QUICK_REF.md | OPERATIONAL_SAFETY_PROCEDURES.md
            </p>
        </div>
    </div>
</body>
</html>
